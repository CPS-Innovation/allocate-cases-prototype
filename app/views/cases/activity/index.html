{% extends "layouts/main.html" %}
{% set navId = 'cases' %}
{% set secondaryNavId = 'activity' %}
{% set pageName = 'Activity' %}

{% block beforeContent %}
  {% include "_includes/case-identity-bar.njk" %}
{% endblock %}

{% block content %}
  {% include "_includes/success-banner.njk" %}
  {% include "_includes/case-navigation.njk" %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">{{pageName}}</h1>
      
      {% if events.length %}
        <div class="app-activity-log">
          {% for event in events %}
            <div class="app-activity-log__item">
              <div class="app-activity-log__header">
                <h2 class="app-activity-log__title govuk-heading-s govuk-!-font-size-24 govuk-!-margin-bottom-1">{{event.title}}</h2>
                <p class="app-activity-log__byline">
                  {% if event.user %}
                    {{event.user.email}},
                  {% endif %}
                  <time datetime="{{ event.createdAt }}">
                    {{- event.createdAt | isoDateString | govukDateTime -}}
                  </time>
                </p>
              </div>
              <div class="app-activity-log__description">
                <div class="app-activity-log__box">
                  {{ govukSummaryList({
                    rows: [
                      {
                        key: {
                          text: "Witness"
                        },
                        value: {
                          text: event.meta.witness.firstName + ' ' + event.meta.witness.lastName
                        }
                      }
                    ]
                  }) }}
                </div>

                <p class="app-log-card__note--link">
                  <a class="govuk-link" href="/cases/{{ event.case.id }}/witnesses">View witness</a>
                </p>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p>No events.</p>
      {% endif %}


    </div>
  </div>
{% endblock %}
